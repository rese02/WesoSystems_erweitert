rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    // Der Pfad für die Dokumente eines Gastes.
    // {bookingId} ist die geheime, unerratbare ID der Buchung.
    match /bookings/{bookingId}/{fileName} {
      
      // ERLAUBT: Einen Schreibzugriff (Upload) für JEDEN.
      // Das ist sicher, weil niemand die bookingId erraten kann.
      // Sie funktioniert wie ein einmaliges Upload-Passwort.
      allow write: if true;

      // VERHINDERT: Dass ein Gast die Dokumente anderer Gäste lesen kann.
      // Leserechte haben nur eingeloggte Benutzer (deine Hoteliers).
      allow read: if request.auth != null;
    }
  }
}
